function cov_ovqqcv4x8() {
  var path = "C:\\Users\\juraj\\naty\\2\\ToolJet-develop-2\\frontend\\src\\_services\\authentication.service.js";
  var hash = "f5b4313f540bfbd5c91b398ca364fc669fe65cf9";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\juraj\\naty\\2\\ToolJet-develop-2\\frontend\\src\\_services\\authentication.service.js",
    statementMap: {
      "0": {
        start: {
          line: 5,
          column: 27
        },
        end: {
          line: 5,
          column: 95
        }
      },
      "1": {
        start: {
          line: 7,
          column: 37
        },
        end: {
          line: 17,
          column: 1
        }
      },
      "2": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 14,
          column: 36
        }
      },
      "3": {
        start: {
          line: 20,
          column: 25
        },
        end: {
          line: 24,
          column: 3
        }
      },
      "4": {
        start: {
          line: 26,
          column: 2
        },
        end: {
          line: 34,
          column: 7
        }
      },
      "5": {
        start: {
          line: 30,
          column: 6
        },
        end: {
          line: 30,
          column: 64
        }
      },
      "6": {
        start: {
          line: 31,
          column: 6
        },
        end: {
          line: 31,
          column: 36
        }
      },
      "7": {
        start: {
          line: 33,
          column: 6
        },
        end: {
          line: 33,
          column: 18
        }
      },
      "8": {
        start: {
          line: 38,
          column: 29
        },
        end: {
          line: 38,
          column: 76
        }
      },
      "9": {
        start: {
          line: 39,
          column: 29
        },
        end: {
          line: 39,
          column: 75
        }
      },
      "10": {
        start: {
          line: 40,
          column: 2
        },
        end: {
          line: 40,
          column: 74
        }
      },
      "11": {
        start: {
          line: 41,
          column: 2
        },
        end: {
          line: 41,
          column: 46
        }
      },
      "12": {
        start: {
          line: 45,
          column: 25
        },
        end: {
          line: 49,
          column: 3
        }
      },
      "13": {
        start: {
          line: 51,
          column: 2
        },
        end: {
          line: 55,
          column: 7
        }
      },
      "14": {
        start: {
          line: 54,
          column: 6
        },
        end: {
          line: 54,
          column: 18
        }
      },
      "15": {
        start: {
          line: 60,
          column: 2
        },
        end: {
          line: 60,
          column: 41
        }
      },
      "16": {
        start: {
          line: 61,
          column: 2
        },
        end: {
          line: 61,
          column: 32
        }
      },
      "17": {
        start: {
          line: 62,
          column: 2
        },
        end: {
          line: 62,
          column: 64
        }
      },
      "18": {
        start: {
          line: 66,
          column: 25
        },
        end: {
          line: 70,
          column: 3
        }
      },
      "19": {
        start: {
          line: 72,
          column: 2
        },
        end: {
          line: 79,
          column: 7
        }
      },
      "20": {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 75,
          column: 64
        }
      },
      "21": {
        start: {
          line: 76,
          column: 6
        },
        end: {
          line: 76,
          column: 36
        }
      },
      "22": {
        start: {
          line: 78,
          column: 6
        },
        end: {
          line: 78,
          column: 18
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 13,
            column: 2
          },
          end: {
            line: 13,
            column: 3
          }
        },
        loc: {
          start: {
            line: 13,
            column: 25
          },
          end: {
            line: 15,
            column: 3
          }
        },
        line: 13
      },
      "1": {
        name: "login",
        decl: {
          start: {
            line: 19,
            column: 9
          },
          end: {
            line: 19,
            column: 14
          }
        },
        loc: {
          start: {
            line: 19,
            column: 32
          },
          end: {
            line: 35,
            column: 1
          }
        },
        line: 19
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 28,
            column: 10
          },
          end: {
            line: 28,
            column: 11
          }
        },
        loc: {
          start: {
            line: 28,
            column: 20
          },
          end: {
            line: 34,
            column: 5
          }
        },
        line: 28
      },
      "3": {
        name: "updateCurrentUserDetails",
        decl: {
          start: {
            line: 37,
            column: 9
          },
          end: {
            line: 37,
            column: 33
          }
        },
        loc: {
          start: {
            line: 37,
            column: 43
          },
          end: {
            line: 42,
            column: 1
          }
        },
        line: 37
      },
      "4": {
        name: "signup",
        decl: {
          start: {
            line: 44,
            column: 9
          },
          end: {
            line: 44,
            column: 15
          }
        },
        loc: {
          start: {
            line: 44,
            column: 23
          },
          end: {
            line: 56,
            column: 1
          }
        },
        line: 44
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 53,
            column: 10
          },
          end: {
            line: 53,
            column: 11
          }
        },
        loc: {
          start: {
            line: 53,
            column: 20
          },
          end: {
            line: 55,
            column: 5
          }
        },
        line: 53
      },
      "6": {
        name: "logout",
        decl: {
          start: {
            line: 58,
            column: 9
          },
          end: {
            line: 58,
            column: 15
          }
        },
        loc: {
          start: {
            line: 58,
            column: 18
          },
          end: {
            line: 63,
            column: 1
          }
        },
        line: 58
      },
      "7": {
        name: "signInViaOAuth",
        decl: {
          start: {
            line: 65,
            column: 9
          },
          end: {
            line: 65,
            column: 23
          }
        },
        loc: {
          start: {
            line: 65,
            column: 31
          },
          end: {
            line: 80,
            column: 1
          }
        },
        line: 65
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 74,
            column: 10
          },
          end: {
            line: 74,
            column: 11
          }
        },
        loc: {
          start: {
            line: 74,
            column: 20
          },
          end: {
            line: 79,
            column: 5
          }
        },
        line: 74
      }
    },
    branchMap: {},
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0
    },
    b: {},
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "f5b4313f540bfbd5c91b398ca364fc669fe65cf9"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_ovqqcv4x8 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_ovqqcv4x8();
import { BehaviorSubject } from 'rxjs';
import { history, handleResponse } from '@/_helpers';
import config from 'config';
const currentUserSubject = (cov_ovqqcv4x8().s[0]++, new BehaviorSubject(JSON.parse(localStorage.getItem('currentUser'))));
export const authenticationService = (cov_ovqqcv4x8().s[1]++, {
  login,
  logout,
  signup,
  updateCurrentUserDetails,
  currentUser: currentUserSubject.asObservable(),

  get currentUserValue() {
    cov_ovqqcv4x8().f[0]++;
    cov_ovqqcv4x8().s[2]++;
    return currentUserSubject.value;
  },

  signInViaOAuth
});

function login(email, password) {
  cov_ovqqcv4x8().f[1]++;
  const requestOptions = (cov_ovqqcv4x8().s[3]++, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      email,
      password
    })
  });
  cov_ovqqcv4x8().s[4]++;
  return fetch(`${config.apiUrl}/authenticate`, requestOptions).then(handleResponse).then(user => {
    cov_ovqqcv4x8().f[2]++;
    cov_ovqqcv4x8().s[5]++;
    // store user details and jwt token in local storage to keep user logged in between page refreshes
    localStorage.setItem('currentUser', JSON.stringify(user));
    cov_ovqqcv4x8().s[6]++;
    currentUserSubject.next(user);
    cov_ovqqcv4x8().s[7]++;
    return user;
  });
}

function updateCurrentUserDetails(details) {
  cov_ovqqcv4x8().f[3]++;
  const currentUserDetails = (cov_ovqqcv4x8().s[8]++, JSON.parse(localStorage.getItem('currentUser')));
  const updatedUserDetails = (cov_ovqqcv4x8().s[9]++, Object.assign({}, currentUserDetails, details));
  cov_ovqqcv4x8().s[10]++;
  localStorage.setItem('currentUser', JSON.stringify(updatedUserDetails));
  cov_ovqqcv4x8().s[11]++;
  currentUserSubject.next(updatedUserDetails);
}

function signup(email) {
  cov_ovqqcv4x8().f[4]++;
  const requestOptions = (cov_ovqqcv4x8().s[12]++, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      email
    })
  });
  cov_ovqqcv4x8().s[13]++;
  return fetch(`${config.apiUrl}/signup`, requestOptions).then(handleResponse).then(user => {
    cov_ovqqcv4x8().f[5]++;
    cov_ovqqcv4x8().s[14]++;
    return user;
  });
}

function logout() {
  cov_ovqqcv4x8().f[6]++;
  cov_ovqqcv4x8().s[15]++;
  // remove user from local storage to log user out
  localStorage.removeItem('currentUser');
  cov_ovqqcv4x8().s[16]++;
  currentUserSubject.next(null);
  cov_ovqqcv4x8().s[17]++;
  history.push(`/login?redirectTo=${window.location.pathname}`);
}

function signInViaOAuth(token) {
  cov_ovqqcv4x8().f[7]++;
  const requestOptions = (cov_ovqqcv4x8().s[18]++, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      token
    })
  });
  cov_ovqqcv4x8().s[19]++;
  return fetch(`${config.apiUrl}/oauth/sign-in`, requestOptions).then(handleResponse).then(user => {
    cov_ovqqcv4x8().f[8]++;
    cov_ovqqcv4x8().s[20]++;
    localStorage.setItem('currentUser', JSON.stringify(user));
    cov_ovqqcv4x8().s[21]++;
    currentUserSubject.next(user);
    cov_ovqqcv4x8().s[22]++;
    return user;
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0aW9uLnNlcnZpY2UuanMiXSwibmFtZXMiOlsiQmVoYXZpb3JTdWJqZWN0IiwiaGlzdG9yeSIsImhhbmRsZVJlc3BvbnNlIiwiY29uZmlnIiwiY3VycmVudFVzZXJTdWJqZWN0IiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImF1dGhlbnRpY2F0aW9uU2VydmljZSIsImxvZ2luIiwibG9nb3V0Iiwic2lnbnVwIiwidXBkYXRlQ3VycmVudFVzZXJEZXRhaWxzIiwiY3VycmVudFVzZXIiLCJhc09ic2VydmFibGUiLCJjdXJyZW50VXNlclZhbHVlIiwidmFsdWUiLCJzaWduSW5WaWFPQXV0aCIsImVtYWlsIiwicGFzc3dvcmQiLCJyZXF1ZXN0T3B0aW9ucyIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5naWZ5IiwiZmV0Y2giLCJhcGlVcmwiLCJ0aGVuIiwidXNlciIsInNldEl0ZW0iLCJuZXh0IiwiZGV0YWlscyIsImN1cnJlbnRVc2VyRGV0YWlscyIsInVwZGF0ZWRVc2VyRGV0YWlscyIsIk9iamVjdCIsImFzc2lnbiIsInJlbW92ZUl0ZW0iLCJwdXNoIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInRva2VuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWVZOzs7Ozs7Ozs7QUFmWixTQUFTQSxlQUFULFFBQWdDLE1BQWhDO0FBQ0EsU0FBU0MsT0FBVCxFQUFrQkMsY0FBbEIsUUFBd0MsWUFBeEM7QUFDQSxPQUFPQyxNQUFQLE1BQW1CLFFBQW5CO0FBRUEsTUFBTUMsa0JBQWtCLDRCQUFHLElBQUlKLGVBQUosQ0FBb0JLLElBQUksQ0FBQ0MsS0FBTCxDQUFXQyxZQUFZLENBQUNDLE9BQWIsQ0FBcUIsYUFBckIsQ0FBWCxDQUFwQixDQUFILENBQXhCO0FBRUEsT0FBTyxNQUFNQyxxQkFBcUIsNEJBQUc7QUFDbkNDLEVBQUFBLEtBRG1DO0FBRW5DQyxFQUFBQSxNQUZtQztBQUduQ0MsRUFBQUEsTUFIbUM7QUFJbkNDLEVBQUFBLHdCQUptQztBQUtuQ0MsRUFBQUEsV0FBVyxFQUFFVixrQkFBa0IsQ0FBQ1csWUFBbkIsRUFMc0I7O0FBTW5DLE1BQUlDLGdCQUFKLEdBQXVCO0FBQUE7QUFBQTtBQUNyQixXQUFPWixrQkFBa0IsQ0FBQ2EsS0FBMUI7QUFDRCxHQVJrQzs7QUFTbkNDLEVBQUFBO0FBVG1DLENBQUgsQ0FBM0I7O0FBWVAsU0FBU1IsS0FBVCxDQUFlUyxLQUFmLEVBQXNCQyxRQUF0QixFQUFnQztBQUFBO0FBQzlCLFFBQU1DLGNBQWMsNEJBQUc7QUFDckJDLElBQUFBLE1BQU0sRUFBRSxNQURhO0FBRXJCQyxJQUFBQSxPQUFPLEVBQUU7QUFBRSxzQkFBZ0I7QUFBbEIsS0FGWTtBQUdyQkMsSUFBQUEsSUFBSSxFQUFFbkIsSUFBSSxDQUFDb0IsU0FBTCxDQUFlO0FBQUVOLE1BQUFBLEtBQUY7QUFBU0MsTUFBQUE7QUFBVCxLQUFmO0FBSGUsR0FBSCxDQUFwQjtBQUQ4QjtBQU85QixTQUFPTSxLQUFLLENBQUUsR0FBRXZCLE1BQU0sQ0FBQ3dCLE1BQU8sZUFBbEIsRUFBa0NOLGNBQWxDLENBQUwsQ0FDSk8sSUFESSxDQUNDMUIsY0FERCxFQUVKMEIsSUFGSSxDQUVFQyxJQUFELElBQVU7QUFBQTtBQUFBO0FBQ2Q7QUFDQXRCLElBQUFBLFlBQVksQ0FBQ3VCLE9BQWIsQ0FBcUIsYUFBckIsRUFBb0N6QixJQUFJLENBQUNvQixTQUFMLENBQWVJLElBQWYsQ0FBcEM7QUFGYztBQUdkekIsSUFBQUEsa0JBQWtCLENBQUMyQixJQUFuQixDQUF3QkYsSUFBeEI7QUFIYztBQUtkLFdBQU9BLElBQVA7QUFDRCxHQVJJLENBQVA7QUFTRDs7QUFFRCxTQUFTaEIsd0JBQVQsQ0FBa0NtQixPQUFsQyxFQUEyQztBQUFBO0FBQ3pDLFFBQU1DLGtCQUFrQiw0QkFBRzVCLElBQUksQ0FBQ0MsS0FBTCxDQUFXQyxZQUFZLENBQUNDLE9BQWIsQ0FBcUIsYUFBckIsQ0FBWCxDQUFILENBQXhCO0FBQ0EsUUFBTTBCLGtCQUFrQiw0QkFBR0MsTUFBTSxDQUFDQyxNQUFQLENBQWMsRUFBZCxFQUFrQkgsa0JBQWxCLEVBQXNDRCxPQUF0QyxDQUFILENBQXhCO0FBRnlDO0FBR3pDekIsRUFBQUEsWUFBWSxDQUFDdUIsT0FBYixDQUFxQixhQUFyQixFQUFvQ3pCLElBQUksQ0FBQ29CLFNBQUwsQ0FBZVMsa0JBQWYsQ0FBcEM7QUFIeUM7QUFJekM5QixFQUFBQSxrQkFBa0IsQ0FBQzJCLElBQW5CLENBQXdCRyxrQkFBeEI7QUFDRDs7QUFFRCxTQUFTdEIsTUFBVCxDQUFnQk8sS0FBaEIsRUFBdUI7QUFBQTtBQUNyQixRQUFNRSxjQUFjLDZCQUFHO0FBQ3JCQyxJQUFBQSxNQUFNLEVBQUUsTUFEYTtBQUVyQkMsSUFBQUEsT0FBTyxFQUFFO0FBQUUsc0JBQWdCO0FBQWxCLEtBRlk7QUFHckJDLElBQUFBLElBQUksRUFBRW5CLElBQUksQ0FBQ29CLFNBQUwsQ0FBZTtBQUFFTixNQUFBQTtBQUFGLEtBQWY7QUFIZSxHQUFILENBQXBCO0FBRHFCO0FBT3JCLFNBQU9PLEtBQUssQ0FBRSxHQUFFdkIsTUFBTSxDQUFDd0IsTUFBTyxTQUFsQixFQUE0Qk4sY0FBNUIsQ0FBTCxDQUNKTyxJQURJLENBQ0MxQixjQURELEVBRUowQixJQUZJLENBRUVDLElBQUQsSUFBVTtBQUFBO0FBQUE7QUFDZCxXQUFPQSxJQUFQO0FBQ0QsR0FKSSxDQUFQO0FBS0Q7O0FBRUQsU0FBU2xCLE1BQVQsR0FBa0I7QUFBQTtBQUFBO0FBQ2hCO0FBQ0FKLEVBQUFBLFlBQVksQ0FBQzhCLFVBQWIsQ0FBd0IsYUFBeEI7QUFGZ0I7QUFHaEJqQyxFQUFBQSxrQkFBa0IsQ0FBQzJCLElBQW5CLENBQXdCLElBQXhCO0FBSGdCO0FBSWhCOUIsRUFBQUEsT0FBTyxDQUFDcUMsSUFBUixDQUFjLHFCQUFvQkMsTUFBTSxDQUFDQyxRQUFQLENBQWdCQyxRQUFTLEVBQTNEO0FBQ0Q7O0FBRUQsU0FBU3ZCLGNBQVQsQ0FBd0J3QixLQUF4QixFQUErQjtBQUFBO0FBQzdCLFFBQU1yQixjQUFjLDZCQUFHO0FBQ3JCQyxJQUFBQSxNQUFNLEVBQUUsTUFEYTtBQUVyQkMsSUFBQUEsT0FBTyxFQUFFO0FBQUUsc0JBQWdCO0FBQWxCLEtBRlk7QUFHckJDLElBQUFBLElBQUksRUFBRW5CLElBQUksQ0FBQ29CLFNBQUwsQ0FBZTtBQUFFaUIsTUFBQUE7QUFBRixLQUFmO0FBSGUsR0FBSCxDQUFwQjtBQUQ2QjtBQU83QixTQUFPaEIsS0FBSyxDQUFFLEdBQUV2QixNQUFNLENBQUN3QixNQUFPLGdCQUFsQixFQUFtQ04sY0FBbkMsQ0FBTCxDQUNKTyxJQURJLENBQ0MxQixjQURELEVBRUowQixJQUZJLENBRUVDLElBQUQsSUFBVTtBQUFBO0FBQUE7QUFDZHRCLElBQUFBLFlBQVksQ0FBQ3VCLE9BQWIsQ0FBcUIsYUFBckIsRUFBb0N6QixJQUFJLENBQUNvQixTQUFMLENBQWVJLElBQWYsQ0FBcEM7QUFEYztBQUVkekIsSUFBQUEsa0JBQWtCLENBQUMyQixJQUFuQixDQUF3QkYsSUFBeEI7QUFGYztBQUlkLFdBQU9BLElBQVA7QUFDRCxHQVBJLENBQVA7QUFRRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgaGlzdG9yeSwgaGFuZGxlUmVzcG9uc2UgfSBmcm9tICdAL19oZWxwZXJzJztcbmltcG9ydCBjb25maWcgZnJvbSAnY29uZmlnJztcblxuY29uc3QgY3VycmVudFVzZXJTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50VXNlcicpKSk7XG5cbmV4cG9ydCBjb25zdCBhdXRoZW50aWNhdGlvblNlcnZpY2UgPSB7XG4gIGxvZ2luLFxuICBsb2dvdXQsXG4gIHNpZ251cCxcbiAgdXBkYXRlQ3VycmVudFVzZXJEZXRhaWxzLFxuICBjdXJyZW50VXNlcjogY3VycmVudFVzZXJTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLFxuICBnZXQgY3VycmVudFVzZXJWYWx1ZSgpIHtcbiAgICByZXR1cm4gY3VycmVudFVzZXJTdWJqZWN0LnZhbHVlO1xuICB9LFxuICBzaWduSW5WaWFPQXV0aCxcbn07XG5cbmZ1bmN0aW9uIGxvZ2luKGVtYWlsLCBwYXNzd29yZCkge1xuICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBwYXNzd29yZCB9KSxcbiAgfTtcblxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmFwaVVybH0vYXV0aGVudGljYXRlYCwgcmVxdWVzdE9wdGlvbnMpXG4gICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXG4gICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgIC8vIHN0b3JlIHVzZXIgZGV0YWlscyBhbmQgand0IHRva2VuIGluIGxvY2FsIHN0b3JhZ2UgdG8ga2VlcCB1c2VyIGxvZ2dlZCBpbiBiZXR3ZWVuIHBhZ2UgcmVmcmVzaGVzXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFVzZXInLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gICAgICBjdXJyZW50VXNlclN1YmplY3QubmV4dCh1c2VyKTtcblxuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyRGV0YWlscyhkZXRhaWxzKSB7XG4gIGNvbnN0IGN1cnJlbnRVc2VyRGV0YWlscyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRVc2VyJykpO1xuICBjb25zdCB1cGRhdGVkVXNlckRldGFpbHMgPSBPYmplY3QuYXNzaWduKHt9LCBjdXJyZW50VXNlckRldGFpbHMsIGRldGFpbHMpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFVzZXInLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkVXNlckRldGFpbHMpKTtcbiAgY3VycmVudFVzZXJTdWJqZWN0Lm5leHQodXBkYXRlZFVzZXJEZXRhaWxzKTtcbn1cblxuZnVuY3Rpb24gc2lnbnVwKGVtYWlsKSB7XG4gIGNvbnN0IHJlcXVlc3RPcHRpb25zID0ge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZW1haWwgfSksXG4gIH07XG5cbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5hcGlVcmx9L3NpZ251cGAsIHJlcXVlc3RPcHRpb25zKVxuICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gbG9nb3V0KCkge1xuICAvLyByZW1vdmUgdXNlciBmcm9tIGxvY2FsIHN0b3JhZ2UgdG8gbG9nIHVzZXIgb3V0XG4gIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjdXJyZW50VXNlcicpO1xuICBjdXJyZW50VXNlclN1YmplY3QubmV4dChudWxsKTtcbiAgaGlzdG9yeS5wdXNoKGAvbG9naW4/cmVkaXJlY3RUbz0ke3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZX1gKTtcbn1cblxuZnVuY3Rpb24gc2lnbkluVmlhT0F1dGgodG9rZW4pIHtcbiAgY29uc3QgcmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB0b2tlbiB9KSxcbiAgfTtcblxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmFwaVVybH0vb2F1dGgvc2lnbi1pbmAsIHJlcXVlc3RPcHRpb25zKVxuICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFVzZXInLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gICAgICBjdXJyZW50VXNlclN1YmplY3QubmV4dCh1c2VyKTtcblxuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSk7XG59XG4iXX0=